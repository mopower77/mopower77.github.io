---
layout: post
title:  "wiredTiger 내부 작동 방식"
summary: "MongoDB의 wiredTiger 스토리지 엔진"
author: mopower77
date: '2021-04-23'
category: mongodb
thumbnail: /assets/img/mongo/wired.png
---

# 내부 작동 방식
 사용자가 데이터를 변경하면 트랜잭션을 시작하고 커서를 이용해 도큐먼트를 변경, 변경된 도큐먼트는 버퍼풀에 적용, 저널로그에 저장한 뒤 결과값을 리턴한다.
 버퍼풀(캐시)이 어느정도 쌓이게 되면 체크포인트를 발생시켜 버퍼풀에 더티 페이지를 모아 디스크에 기록한다.
 디스크에 저장하기전에 원본(old)데이터와 변경된(new) 데이터간의 병합작업을 진행하는데 이를 리컨실리에이션 모듈이 담당한다.

 사용자가 쿼리를 실행하면 WiredTiger 스토리지 엔진은 블록매니저를 통해서 필요한 데이터를 버퍼풀에 적재한뒤 쿼리를 처리한다.
 이때 버퍼풀(캐시)에 공간이 부족해지면 이빅션 모듈이 버퍼풀에서 사용되지 않는 데이터페이지를 삭제 하는데 삭제해야하는 페이지가 더티 페이지라면 리컨실리에이션 모듈을 이용해 디스크에 기록하고 버퍼풀에서 제거한다.


 